{"mappings":"gfAAA,IAAAA,EAAAC,EAAA,S,0BAIMC,EAAO,CACXC,SAAUC,SAASC,cAAc,cACjCC,YAAaF,SAASC,cAAc,uBACpCE,MAAOH,SAASC,cAAc,WAehC,SAASG,IACP,IAZMC,EACAC,EAWAC,GAZAF,GAAW,EAAAT,EAAAY,eACXF,GAAO,EAAAG,EAAAC,WACMC,OAAOC,KAAKN,GAAMO,IAAIC,QAEvBC,QAAO,SAACC,EAAKC,GAC7B,IAAMC,EAAUb,EAASc,MAAK,SAAAC,G,OAAWA,EAAQH,KAAOA,C,IAClDI,EAAQf,EAAKW,GACnB,OAAOD,EAAME,EAAQI,MAAMC,OAASF,C,GACnC,IAKHvB,EAAKK,MAAMqB,YAAcjB,EAAa,mBAA2CkB,OAAXlB,EAAW,QAAW,E,CAE9F,SAASmB,IACP,IAAMrB,GAAW,EAAAT,EAAAY,eACXF,GAAO,EAAAG,EAAAC,WACPiB,EAAahB,OAAOC,KAAKN,GAAMO,IAAIC,QACzC,IAAKa,EAAWC,OAGd,OAFA9B,EAAKC,SAAS8B,mBAAmB,YAAa,4EAC9CzB,IAGF,IAAM0B,EAASH,EAAWd,KAAI,SAAAI,GAC5B,IAAMc,EAAU1B,EAASc,MAAK,SAAAC,G,OAAWA,EAAQH,KAAOA,C,IAClDI,EAAQf,EAAKW,GACXe,EAAqBD,EAArBC,KAAMV,EAAeS,EAAfT,MAAOW,EAAQF,EAARE,IACrB,MAAO,+EAGMR,OADAQ,EAAI,sBAKsBR,OAJ1BO,EAAK,wHAOmBP,OAHEO,EAAK,mJAGYP,OAAnBJ,EAAM,eAEHI,OAFgBM,EAAQd,GAAG,2HAEXQ,OAAhBH,EAAMC,OAAO,KAC+BE,OAD5BH,EAAMY,SAAS,kGACwBT,OAAXM,EAAQd,GAAG,sB,IAE9FkB,KAAK,IACRrC,EAAKC,SAAS8B,mBAAmB,YAAaC,GAC9C1B,G,CAGF,SAASgC,IACFzB,OAAOC,MAAK,EAAAH,EAAAC,YAAWkB,SAC1B9B,EAAKC,SAASsC,UAAY,GAC1BX,I,CAIJ5B,EAAKC,SAASuC,iBAAiB,SAAS,SAACC,GACnCA,EAAMC,OAAOC,UAAUC,SAAS,0BAClC,EAAAC,EAAAC,gBAAeL,EAAMC,OAAOK,QAAQ5B,IACpCsB,EAAMC,OAAOM,QAAQ,iBAAiBC,SACtC3C,IACAgC,I,IAED,GAEHtC,EAAKC,SAASuC,iBAAiB,UAAU,SAACC,GACxC,GAAIA,EAAMC,OAAOC,UAAUC,SAAS,kBAAmB,CACrD,IAAMM,EAAYlC,OAAOyB,EAAMC,OAAOK,QAAQ5B,IACxCM,EAAST,OAAOyB,EAAMC,OAAOS,OAC/B1B,IACF,EAAAoB,EAAAO,WAAUF,EAAWzB,GACrBnB,OAEA,EAAAuC,EAAAC,gBAAeL,EAAMC,OAAOK,QAAQ5B,IACpCsB,EAAMC,OAAOM,QAAQ,iBAAiBC,SACtC3C,IACAgC,I,KAKNV,G","sources":["src/js/cart.js"],"sourcesContent":["import { getProducts } from './local-storage-service';\r\nimport { getCart } from './session-storage-service';\r\nimport { setAmount, removeFromCart } from './cart-service';\r\n\r\nconst refs = {\r\n  cartList: document.querySelector('#cart-list'),\r\n  showMoreBtn: document.querySelector('#products-show-more'),\r\n  total: document.querySelector('#total'),\r\n}\r\n\r\nfunction getTotalPrice() {\r\n  const products = getProducts();\r\n  const cart = getCart();\r\n  const productIds = Object.keys(cart).map(Number)\r\n\r\n  return productIds.reduce((acc, id) => {\r\n    const product = products.find(product => product.id === id);\r\n    const count = cart[id];\r\n    return acc + product.price.amount * count;\r\n  }, 0);\r\n}\r\n\r\nfunction renderTotalPrice() {\r\n  const totalPrice = getTotalPrice();\r\n  refs.total.textContent = totalPrice ? `Загальна сумма: ${totalPrice} грн` : '';\r\n}\r\nfunction renderProducts() {\r\n  const products = getProducts();\r\n  const cart = getCart();\r\n  const productIds = Object.keys(cart).map(Number)\r\n  if (!productIds.length) {\r\n    refs.cartList.insertAdjacentHTML('beforeend', '<h3 class=\"catalog__list-item\">Спочатку додайте товари в кошик</h3>');\r\n    renderTotalPrice();\r\n    return;\r\n  }\r\n  const markup = productIds.map(id => {\r\n    const product = products.find(product => product.id === id);\r\n    const count = cart[id];\r\n    const { name, price, img } = product;\r\n    return `<li class=\"products-list__item js-cart-item\">\r\n        <img\r\n          src=\"${img}\"\r\n          alt=\"${name}\"\r\n          width=\"80\"\r\n          class=\"products-list__img\"\r\n        />\r\n        <h4 class=\"products-list__title\">${name}</h4>\r\n        <div class=\"products-list__amount form-input\">\r\n          <label for=\"product\"></label>\r\n          <input name=\"product\" value=\"${count}\" data-id=\"${product.id}\" class=\"form-input__input js-amount-iput\" type=\"number\" />\r\n        </div>\r\n        <div class=\"products-list__price\">${price.amount} ${price.currency}</div>\r\n        <a href=\"#\" class=\"js-remove-from-cart products-list__remove-button\" data-id=\"${product.id}\"></a>\r\n      </li>`\r\n  }).join('');\r\n  refs.cartList.insertAdjacentHTML('beforeend', markup);\r\n  renderTotalPrice();\r\n}\r\n\r\nfunction renderIfLastProductRemoved() {\r\n  if (!Object.keys(getCart()).length) {\r\n    refs.cartList.innerHTML = '';\r\n    renderProducts();\r\n  }\r\n}\r\n\r\nrefs.cartList.addEventListener('click', (event) => {\r\n  if (event.target.classList.contains('js-remove-from-cart')) {\r\n    removeFromCart(event.target.dataset.id);\r\n    event.target.closest('.js-cart-item').remove();\r\n    renderTotalPrice();\r\n    renderIfLastProductRemoved();\r\n  }\r\n}, true);\r\n\r\nrefs.cartList.addEventListener('change', (event) => {\r\n  if (event.target.classList.contains('js-amount-iput')) {\r\n    const productId = Number(event.target.dataset.id);\r\n    const amount = Number(event.target.value);\r\n    if (amount) {\r\n      setAmount(productId, amount);\r\n      renderTotalPrice();\r\n    } else {\r\n      removeFromCart(event.target.dataset.id);\r\n      event.target.closest('.js-cart-item').remove();\r\n      renderTotalPrice();\r\n      renderIfLastProductRemoved();\r\n    }\r\n  }\r\n});\r\n\r\nrenderProducts();\r\n"],"names":["$9ekLB","parcelRequire","$ce375e1befa17f1c$var$refs","cartList","document","querySelector","showMoreBtn","total","$ce375e1befa17f1c$var$renderTotalPrice","products","cart","totalPrice","getProducts","$d6Yqd","getCart","Object","keys","map","Number","reduce","acc","id","product1","find","product","count","price","amount","textContent","concat","$ce375e1befa17f1c$var$renderProducts","productIds","length","insertAdjacentHTML","markup","product2","name","img","currency","join","$ce375e1befa17f1c$var$renderIfLastProductRemoved","innerHTML","addEventListener","event","target","classList","contains","$dOocB","removeFromCart","dataset","closest","remove","productId","value","setAmount"],"version":3,"file":"cart.544c583f.js.map"}